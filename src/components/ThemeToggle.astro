---
import { Icon } from "astro-icon/components";
---

<!-- reference: https://yamatatsu-maru.com/blogs/2025-05-14-implement-dark-mode-astro-tailwindcssv4/ -->
<button
  id="theme-toggle"
  type="button"
  class="text-secondary-content hover:text-accent cursor-pointer"
  aria-label="ダークモード切り替え"
>
  <Icon name="mdi:theme-light-dark" size={24} />
</button>

<script>
  function setupThemeToggle() {
    const themeToggle = document.getElementById("theme-toggle");
    if (!themeToggle) return;

    const newToggle = themeToggle.cloneNode(true);
    themeToggle.parentNode?.replaceChild(newToggle, themeToggle);

    newToggle.addEventListener("click", () => {
      const element = document.documentElement;
      element.classList.toggle("dark");
      const isDark = element.classList.contains("dark");
      localStorage.setItem("theme", isDark ? "dark" : "light");
    });
  }

  setupThemeToggle();
  document.addEventListener("astro:page-load", setupThemeToggle);
</script>
